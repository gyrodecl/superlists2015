<!DOCTYPE html>
<html>
<head>
    <meta charset=utf-8">
    <title>Javascript tests</title>
    <link rel="stylesheet" href="qunit.css">
</head>    
<body>
    <div id="qunit"></div>
    <div id="qunit-fixture">
       <a id="id_login">Sign in</a>
    </div>
    
    <script src="../javascript/jquery.js"></script>
    <script src="qunit.js"></script>
    <script src="../javascript/accounts.js"></script>
    <script>
/*global $, test, equal, sinon, Superlists */
/*
test("smoke test", function() {
   //equal(1, 1, "Math works!");
   equal($('.has-error').is(':visible'), true);
   $('.has-error').hide();
   equal($('.has-error').is(':visible'), false);
});
*/

test("initialize binds sign in button to navigator.id.request", function() {
    var requestWasCalled = false;
    var mockRequestFunction = function() { requestWasCalled = true; };
    var mockNavigator = {
        id: {
            request: mockRequestFunction
        }
    };
    
    //initialize adds the event handler for #id_login that will call the .id.request() method;
    Superlists.Accounts.initialize(mockNavigator);
   
    //then clicking on it calls the navigator.id.request() method; 
    $('#id_login').trigger('click');
    
    equal(requestWasCalled, true);
});

    </script>
</body>    
</html>